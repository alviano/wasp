input = """
1 2 0 0
1 3 0 0
1 4 0 0
1 5 0 0
1 6 0 0
1 7 0 0
1 8 2 1 9 10
1 9 2 1 8 10
1 10 0 0
1 11 2 1 12 13
1 12 2 1 11 13
1 13 0 0
1 14 2 1 15 16
1 15 2 1 14 16
1 16 0 0
1 17 2 1 18 19
1 18 2 1 17 19
1 19 0 0
1 20 2 1 21 22
1 21 2 1 20 22
1 22 0 0
5 24 6 5 0 20 17 14 11 8 1 2 3 4 5
5 25 7 5 0 20 17 14 11 8 1 2 3 4 5
1 23 2 1 25 24
5 27 5 5 0 20 17 14 11 8 1 2 3 4 5
5 28 6 5 0 20 17 14 11 8 1 2 3 4 5
1 26 2 1 28 27
5 29 7 5 0 20 17 14 11 8 1 2 3 4 5
5 30 8 5 0 20 17 14 11 8 1 2 3 4 5
1 26 2 1 30 29
5 32 9 5 0 20 17 14 11 8 1 2 3 4 5
1 31 1 1 32
5 34 8 5 0 20 17 14 11 8 1 2 3 4 5
1 33 1 1 34
5 36 7 5 0 20 17 14 11 8 1 2 3 4 5
1 35 1 1 36
5 38 6 5 0 20 17 14 11 8 1 2 3 4 5
1 37 1 1 38
5 40 6 5 0 20 17 14 11 8 1 2 3 4 5
1 39 1 0 40
5 42 7 5 0 20 17 14 11 8 1 2 3 4 5
1 41 1 0 42
5 44 6 5 0 20 17 14 11 8 1 2 3 4 5
1 43 1 0 44
5 46 7 5 0 20 17 14 11 8 1 2 3 4 5
1 45 1 0 46
5 48 6 5 0 20 17 14 11 8 1 2 3 4 5
5 49 7 5 0 20 17 14 11 8 1 2 3 4 5
1 47 2 1 49 48
5 51 5 5 0 20 17 14 11 8 1 2 3 4 5
5 52 6 5 0 20 17 14 11 8 1 2 3 4 5
1 50 2 1 52 51
5 53 7 5 0 20 17 14 11 8 1 2 3 4 5
5 54 8 5 0 20 17 14 11 8 1 2 3 4 5
1 50 2 1 54 53
5 56 9 5 0 20 17 14 11 8 1 2 3 4 5
1 55 1 1 56
5 58 8 5 0 20 17 14 11 8 1 2 3 4 5
1 57 1 1 58
5 60 7 5 0 20 17 14 11 8 1 2 3 4 5
1 59 1 1 60
5 62 6 5 0 20 17 14 11 8 1 2 3 4 5
1 61 1 1 62
5 64 6 5 0 20 17 14 11 8 1 2 3 4 5
1 63 1 0 64
5 66 7 5 0 20 17 14 11 8 1 2 3 4 5
1 65 1 0 66
5 68 6 5 0 20 17 14 11 8 1 2 3 4 5
1 67 1 0 68
5 70 7 5 0 20 17 14 11 8 1 2 3 4 5
1 69 1 0 70
5 72 6 5 0 20 17 14 11 8 1 2 3 4 5
5 73 7 5 0 20 17 14 11 8 1 2 3 4 5
1 71 2 1 73 72
5 75 5 5 0 20 17 14 11 8 1 2 3 4 5
5 76 6 5 0 20 17 14 11 8 1 2 3 4 5
1 74 2 1 76 75
5 77 7 5 0 20 17 14 11 8 1 2 3 4 5
5 78 8 5 0 20 17 14 11 8 1 2 3 4 5
1 74 2 1 78 77
5 80 9 5 0 20 17 14 11 8 1 2 3 4 5
1 79 1 1 80
5 82 8 5 0 20 17 14 11 8 1 2 3 4 5
1 81 1 1 82
5 84 7 5 0 20 17 14 11 8 1 2 3 4 5
1 83 1 1 84
5 86 6 5 0 20 17 14 11 8 1 2 3 4 5
1 85 1 1 86
5 88 6 5 0 20 17 14 11 8 1 2 3 4 5
1 87 1 0 88
5 90 7 5 0 20 17 14 11 8 1 2 3 4 5
1 89 1 0 90
5 92 6 5 0 20 17 14 11 8 1 2 3 4 5
1 91 1 0 92
5 94 7 5 0 20 17 14 11 8 1 2 3 4 5
1 93 1 0 94
5 96 6 5 0 20 17 14 11 8 1 2 3 4 5
5 97 7 5 0 20 17 14 11 8 1 2 3 4 5
1 95 2 1 97 96
5 99 5 5 0 20 17 14 11 8 1 2 3 4 5
5 100 6 5 0 20 17 14 11 8 1 2 3 4 5
1 98 2 1 100 99
5 101 7 5 0 20 17 14 11 8 1 2 3 4 5
5 102 8 5 0 20 17 14 11 8 1 2 3 4 5
1 98 2 1 102 101
5 104 6 5 0 20 17 14 11 8 1 2 3 4 5
1 103 1 0 104
5 106 7 5 0 20 17 14 11 8 1 2 3 4 5
1 105 1 0 106
5 108 6 5 0 20 17 14 11 8 1 2 3 4 5
1 107 1 0 108
5 110 7 5 0 20 17 14 11 8 1 2 3 4 5
1 109 1 0 110
5 112 9 5 0 20 17 14 11 8 1 2 3 4 5
1 111 1 1 112
5 114 8 5 0 20 17 14 11 8 1 2 3 4 5
1 113 1 1 114
5 116 7 5 0 20 17 14 11 8 1 2 3 4 5
1 115 1 1 116
5 118 6 5 0 20 17 14 11 8 1 2 3 4 5
1 117 1 1 118
5 120 6 5 0 20 17 14 11 8 1 2 3 4 5
5 121 7 5 0 20 17 14 11 8 1 2 3 4 5
1 119 2 1 121 120
5 123 5 5 0 20 17 14 11 8 1 2 3 4 5
5 124 6 5 0 20 17 14 11 8 1 2 3 4 5
1 122 2 1 124 123
5 125 7 5 0 20 17 14 11 8 1 2 3 4 5
5 126 8 5 0 20 17 14 11 8 1 2 3 4 5
1 122 2 1 126 125
5 128 6 5 0 20 17 14 11 8 1 2 3 4 5
1 127 1 0 128
5 130 7 5 0 20 17 14 11 8 1 2 3 4 5
1 129 1 0 130
5 132 6 5 0 20 17 14 11 8 1 2 3 4 5
1 131 1 0 132
5 134 7 5 0 20 17 14 11 8 1 2 3 4 5
1 133 1 0 134
5 136 7 5 0 20 17 14 11 8 1 2 3 4 5
1 135 1 1 136
5 138 6 5 0 20 17 14 11 8 1 2 3 4 5
1 137 1 1 138
5 140 7 5 0 20 17 14 11 8 1 2 3 4 5
1 139 1 1 140
5 142 6 5 0 20 17 14 11 8 1 2 3 4 5
1 141 1 1 142
5 144 6 5 0 20 17 14 11 8 1 2 3 4 5
5 145 7 5 0 20 17 14 11 8 1 2 3 4 5
1 143 2 1 145 144
5 147 5 5 0 20 17 14 11 8 1 2 3 4 5
5 148 6 5 0 20 17 14 11 8 1 2 3 4 5
1 146 2 1 148 147
5 149 7 5 0 20 17 14 11 8 1 2 3 4 5
5 150 8 5 0 20 17 14 11 8 1 2 3 4 5
1 146 2 1 150 149
5 152 6 5 0 20 17 14 11 8 1 2 3 4 5
1 151 1 0 152
5 154 7 5 0 20 17 14 11 8 1 2 3 4 5
1 153 1 0 154
5 156 6 5 0 20 17 14 11 8 1 2 3 4 5
1 155 1 0 156
5 158 7 5 0 20 17 14 11 8 1 2 3 4 5
1 157 1 0 158
5 160 7 5 0 20 17 14 11 8 1 2 3 4 5
1 159 1 1 160
5 162 6 5 0 20 17 14 11 8 1 2 3 4 5
1 161 1 1 162
5 164 7 5 0 20 17 14 11 8 1 2 3 4 5
1 163 1 1 164
5 166 6 5 0 20 17 14 11 8 1 2 3 4 5
1 165 1 1 166
5 168 4 5 0 20 17 14 11 8 1 2 3 4 5
5 169 7 5 0 20 17 14 11 8 1 2 3 4 5
1 167 2 1 169 168
5 171 4 5 0 20 17 14 11 8 1 2 3 4 5
5 172 6 5 0 20 17 14 11 8 1 2 3 4 5
1 170 2 1 172 171
5 173 5 5 0 20 17 14 11 8 1 2 3 4 5
5 174 7 5 0 20 17 14 11 8 1 2 3 4 5
1 170 2 1 174 173
5 176 4 5 0 20 17 14 11 8 1 2 3 4 5
5 177 7 5 0 20 17 14 11 8 1 2 3 4 5
1 175 2 1 177 176
5 179 4 5 0 20 17 14 11 8 1 2 3 4 5
5 180 6 5 0 20 17 14 11 8 1 2 3 4 5
1 178 2 1 180 179
5 181 5 5 0 20 17 14 11 8 1 2 3 4 5
5 182 7 5 0 20 17 14 11 8 1 2 3 4 5
1 178 2 1 182 181
5 184 4 5 0 20 17 14 11 8 1 2 3 4 5
5 185 7 5 0 20 17 14 11 8 1 2 3 4 5
1 183 2 1 185 184
5 187 4 5 0 20 17 14 11 8 1 2 3 4 5
5 188 6 5 0 20 17 14 11 8 1 2 3 4 5
1 186 2 1 188 187
5 189 5 5 0 20 17 14 11 8 1 2 3 4 5
5 190 7 5 0 20 17 14 11 8 1 2 3 4 5
1 186 2 1 190 189
5 192 4 5 0 20 17 14 11 8 1 2 3 4 5
5 193 7 5 0 20 17 14 11 8 1 2 3 4 5
1 191 2 1 193 192
5 195 5 5 0 20 17 14 11 8 1 2 3 4 5
5 196 8 5 0 20 17 14 11 8 1 2 3 4 5
1 194 2 1 196 195
5 198 4 5 0 20 17 14 11 8 1 2 3 4 5
5 199 7 5 0 20 17 14 11 8 1 2 3 4 5
1 197 2 1 199 198
5 201 5 5 0 20 17 14 11 8 1 2 3 4 5
5 202 8 5 0 20 17 14 11 8 1 2 3 4 5
1 200 2 1 202 201
5 204 4 5 0 20 17 14 11 8 1 2 3 4 5
5 205 7 5 0 20 17 14 11 8 1 2 3 4 5
1 203 2 1 205 204
5 207 5 5 0 20 17 14 11 8 1 2 3 4 5
5 208 8 5 0 20 17 14 11 8 1 2 3 4 5
1 206 2 1 208 207
5 210 6 5 0 20 17 14 11 8 1 2 3 4 5
5 211 7 5 0 20 17 14 11 8 1 2 3 4 5
1 209 2 1 211 210
5 213 5 5 0 20 17 14 11 8 1 2 3 4 5
5 214 6 5 0 20 17 14 11 8 1 2 3 4 5
1 212 2 1 214 213
5 215 7 5 0 20 17 14 11 8 1 2 3 4 5
5 216 8 5 0 20 17 14 11 8 1 2 3 4 5
1 212 2 1 216 215
5 218 6 5 0 20 17 14 11 8 1 2 3 4 5
5 219 7 5 0 20 17 14 11 8 1 2 3 4 5
1 217 2 1 219 218
5 221 5 5 0 20 17 14 11 8 1 2 3 4 5
5 222 6 5 0 20 17 14 11 8 1 2 3 4 5
1 220 2 1 222 221
5 223 7 5 0 20 17 14 11 8 1 2 3 4 5
5 224 8 5 0 20 17 14 11 8 1 2 3 4 5
1 220 2 1 224 223
5 226 5 5 0 20 17 14 11 8 1 2 3 4 5
5 227 7 5 0 20 17 14 11 8 1 2 3 4 5
1 225 2 1 227 226
5 229 4 5 0 20 17 14 11 8 1 2 3 4 5
5 230 6 5 0 20 17 14 11 8 1 2 3 4 5
1 228 2 1 230 229
5 232 6 5 0 20 17 14 11 8 1 2 3 4 5
5 233 8 5 0 20 17 14 11 8 1 2 3 4 5
1 231 2 1 233 232
5 235 7 5 0 20 17 14 11 8 1 2 3 4 5
5 236 9 5 0 20 17 14 11 8 1 2 3 4 5
1 234 2 1 236 235
5 238 6 5 0 20 17 14 11 8 1 2 3 4 5
5 239 7 5 0 20 17 14 11 8 1 2 3 4 5
1 237 2 1 239 238
5 241 5 5 0 20 17 14 11 8 1 2 3 4 5
5 242 6 5 0 20 17 14 11 8 1 2 3 4 5
1 240 2 1 242 241
5 243 7 5 0 20 17 14 11 8 1 2 3 4 5
5 244 8 5 0 20 17 14 11 8 1 2 3 4 5
1 240 2 1 244 243
5 246 5 5 0 20 17 14 11 8 1 2 3 4 5
5 247 7 5 0 20 17 14 11 8 1 2 3 4 5
1 245 2 1 247 246
5 249 4 5 0 20 17 14 11 8 1 2 3 4 5
5 250 6 5 0 20 17 14 11 8 1 2 3 4 5
1 248 2 1 250 249
5 252 6 5 0 20 17 14 11 8 1 2 3 4 5
5 253 8 5 0 20 17 14 11 8 1 2 3 4 5
1 251 2 1 253 252
5 255 7 5 0 20 17 14 11 8 1 2 3 4 5
5 256 9 5 0 20 17 14 11 8 1 2 3 4 5
1 254 2 1 256 255
5 258 6 5 0 20 17 14 11 8 1 2 3 4 5
5 259 7 5 0 20 17 14 11 8 1 2 3 4 5
1 257 2 1 259 258
5 261 5 5 0 20 17 14 11 8 1 2 3 4 5
5 262 6 5 0 20 17 14 11 8 1 2 3 4 5
1 260 2 1 262 261
5 263 7 5 0 20 17 14 11 8 1 2 3 4 5
5 264 8 5 0 20 17 14 11 8 1 2 3 4 5
1 260 2 1 264 263
5 266 5 5 0 20 17 14 11 8 1 2 3 4 5
5 267 7 5 0 20 17 14 11 8 1 2 3 4 5
1 265 2 1 267 266
5 269 4 5 0 20 17 14 11 8 1 2 3 4 5
5 270 6 5 0 20 17 14 11 8 1 2 3 4 5
1 268 2 1 270 269
5 272 6 5 0 20 17 14 11 8 1 2 3 4 5
5 273 8 5 0 20 17 14 11 8 1 2 3 4 5
1 271 2 1 273 272
5 275 7 5 0 20 17 14 11 8 1 2 3 4 5
5 276 9 5 0 20 17 14 11 8 1 2 3 4 5
1 274 2 1 276 275
5 278 6 5 0 20 17 14 11 8 1 2 3 4 5
5 279 7 5 0 20 17 14 11 8 1 2 3 4 5
1 277 2 1 279 278
5 281 5 5 0 20 17 14 11 8 1 2 3 4 5
5 282 6 5 0 20 17 14 11 8 1 2 3 4 5
1 280 2 1 282 281
5 283 8 5 0 20 17 14 11 8 1 2 3 4 5
5 284 9 5 0 20 17 14 11 8 1 2 3 4 5
1 280 2 1 284 283
5 285 5 5 0 20 17 14 11 8 1 2 3 4 5
5 286 6 5 0 20 17 14 11 8 1 2 3 4 5
1 1 2 1 286 285
5 287 5 5 0 20 17 14 11 8 1 2 3 4 5
5 288 6 5 0 20 17 14 11 8 1 2 3 4 5
1 1 2 1 288 287
5 289 6 5 0 20 17 14 11 8 1 2 3 4 5
1 1 1 1 289
5 290 4 5 0 20 17 14 11 8 1 2 3 4 5
5 291 6 5 0 20 17 14 11 8 1 2 3 4 5
1 1 2 1 291 290
5 292 5 5 0 20 17 14 11 8 1 2 3 4 5
5 293 7 5 0 20 17 14 11 8 1 2 3 4 5
1 1 2 1 293 292
5 294 5 5 0 20 17 14 11 8 1 2 3 4 5
5 295 7 5 0 20 17 14 11 8 1 2 3 4 5
1 1 2 1 295 294
5 296 4 5 0 20 17 14 11 8 1 2 3 4 5
5 297 7 5 0 20 17 14 11 8 1 2 3 4 5
1 1 2 1 297 296
5 298 4 5 0 20 17 14 11 8 1 2 3 4 5
5 299 7 5 0 20 17 14 11 8 1 2 3 4 5
1 1 2 1 299 298
0
117 ouch20
122 ouch21
98 ouch16
129 ouch22
105 ouch17
133 ouch23
109 ouch18
87 okay14
113 ouch19
200 ouch36
3 c(1)
4 c(2)
5 c(3)
6 c(4)
7 c(5)
228 ouch40
220 ouch39
186 ouch34
178 ouch33
194 ouch35
212 ouch38
91 okay15
79 okay12
83 okay13
163 okay31
39 okay4
206 ouch37
43 okay5
47 okay6
167 okay32
155 okay29
159 okay30
135 okay24
55 okay7
143 okay26
151 okay28
139 okay25
251 okay44
274 ouch47
59 okay8
67 okay10
245 okay43
71 okay11
2 p
63 okay9
237 okay42
231 okay41
265 okay46
31 okay2
35 okay3
257 okay45
115 okay20
119 okay21
95 okay16
127 okay22
8 d(5)
11 d(4)
14 d(3)
17 d(2)
20 d(1)
103 okay17
131 okay23
9 n_d(5)
12 n_d(4)
15 n_d(3)
18 n_d(2)
21 n_d(1)
107 okay18
111 okay19
197 okay36
225 okay40
89 ouch14
217 okay39
191 okay35
183 okay34
81 ouch12
175 okay33
85 ouch13
209 okay38
93 ouch15
41 ouch4
165 ouch31
45 ouch5
203 okay37
157 ouch29
50 ouch6
161 ouch30
170 ouch32
137 ouch24
57 ouch7
141 ouch25
146 ouch27
254 ouch44
153 ouch28
277 okay48
271 okay47
61 ouch8
248 ouch43
23 okay1
280 ouch48
69 ouch10
65 ouch9
74 ouch11
240 ouch42
26 ouch1
234 ouch41
268 ouch46
260 ouch45
33 ouch2
37 ouch3
0
B+
0
B-
1
0
1
"""
output = """
{p, c(1), c(2), c(3), c(4), c(5), ouch29, okay29, ouch28, okay28, ouch23, okay23, ouch22, okay22, ouch18, okay18, ouch17, okay17, ouch15, okay15, ouch14, okay14, ouch10, okay10, ouch9, okay9, ouch5, okay5, ouch4, okay4}
"""
